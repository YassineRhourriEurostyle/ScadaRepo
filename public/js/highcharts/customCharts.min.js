function drawDonutChart(id,title,data){var colors=[],base='#de1128',i,j;for(i=1;i<7;i+=1){c={h:(360/7)*i,l:0.47,s:0.86};colors.push(hslToRGB(c))}
colors.push('#535656');colors.push('#000000');colors.push('#ffffff');var innerData=[],outerData=[];var innerTitle=data[Object.keys(data)[0]].title,outerTitle=data[Object.keys(data)[0]].drilldown.title;for(i=0;i<Object.keys(data).length;i++){var d=data[Object.keys(data)[i]];innerData.push({name:d.drilldown.name,y:parseInt(d.y),color:colors[i%colors.length]});drillDataLen=d.drilldown.data.length;for(j=0;j<drillDataLen;j+=1){brightness=0.2-(j/drillDataLen)/5;outerData.push({name:d.drilldown.categories[j],y:parseFloat(d.drilldown.data[j]),color:desaturate(colors[i%colors.length],j),})}}
return Highcharts.chart(id,{chart:{type:'pie'},title:{text:title},plotOptions:{pie:{shadow:!1,center:['50%','50%']},serie:{turboThreshold:0}},tooltip:{valueSuffix:'MB'},series:[{name:innerTitle,data:innerData,size:'60%',dataLabels:{formatter:function(){return this.y>5?this.point.name:null},color:'#ffffff',distance:-30}},{name:outerTitle,data:outerData,size:'80%',innerSize:'60%',dataLabels:{formatter:function(){return this.y>1?'<b>'+this.point.name+':</b> '+this.y+' MB':null}},id:'outerData'}],responsive:{rules:[{condition:{maxWidth:400},chartOptions:{series:[{},{id:'outerData',dataLabels:{enabled:!1}}]}}]}})};function drawLineChart(id,title,datas,unit='Amount (kâ‚¬)',categories=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],band=1000000){Highcharts.chart(id,{chart:{events:{redraw:function(event){if(typeof HighChartsRedraw!=='undefined'){HighChartsRedraw(id)}}},},exporting:{buttons:{contextButton:{menuItems:["viewFullscreen","separator","downloadPNG","downloadPDF"]}}},title:{text:title},subtitle:{text:""},xAxis:{categories:categories,plotBands:[{from:band-0.5,to:band+0.5,color:'#E3F6FC'}]},yAxis:{title:{text:unit},min:0,labels:{format:'{value}'}},legend:{align:'right',verticalAlign:'top',layout:'vertical',y:35,width:100,useHTML:!0,},plotOptions:{line:{showInLegend:!0,},series:{label:{connectorAllowed:!1}}},series:datas.series,tooltip:{useHTML:!0,formatter:function(){var s='<table><tr><td class="standard-black" colspan="2" style="border-bottom:2px solid #565656"><b>'+this.x+'</b></td></tr>',sum=0;$.each(this.points,function(i,point){s+='<tr><td><i class="fas fa-slash" style="color:'+point.series.color+';"></i> '+point.series.name+'</td>'+'<td class="standard-black" style="text-align:right;padding-left:5px;"><b>'+(new Intl.NumberFormat('fr-FR').format(point.y))+'</b></td></tr>'});s+='</table>';return s},shared:!0,},responsive:{rules:[{condition:{maxWidth:500},chartOptions:{legend:{layout:'horizontal',align:'center',verticalAlign:'bottom'}}}]}})};function drawPieChart(id,title,datas){var colors=[],base='#de1128',i;for(i=1;i<7;i+=1){c={h:(360/7)*i,l:0.47,s:0.86};colors.push(hslToRGB(c))}
colors.push('#535656');colors.push('#000000');colors.push('#ffffff');Highcharts.chart(id,{exporting:{buttons:{contextButton:{menuItems:["viewFullscreen","separator","downloadPNG","downloadPDF"]}}},chart:{type:'pie',options3d:{enabled:!0,alpha:45,beta:0}},title:{text:title},tooltip:{pointFormat:'{series.name}: <b>{point.percentage:.1f}%</b>'},plotOptions:{pie:{allowPointSelect:!0,cursor:'pointer',depth:35,colors:colors,dataLabels:{enabled:!1,format:'{point.name}'},showInLegend:!0},series:{cursor:'pointer',events:{click:function(event){rev=$('#filterRev').val();type=0;purpose=0;search='';if($('#filterSite').length){site=$('#filterSite').val();search=encodeURI(event.point.options.name)}else{site='0/'+encodeURI(event.point.options.name)+'/0'}
if($('#filterType').length)type=$('#filterType').val();window.open('/budget/'+site+'/'+rev+'/'+type+'/'+purpose+'?search='+search)}}}},series:[{name:'Serie',colorByPoint:!0,data:datas}]})};function drawDualPieChart(id,title,datas){var colors=[],base='#de1128',i;for(i=1;i<7;i+=1){c={h:(360/7)*i,l:0.47,s:0.86};colors.push(hslToRGB(c))}
colors.push('#535656');colors.push('#000000');colors.push('#ffffff');datas[0].showInLegend=!0;datas[1].showInLegend=!1;Highcharts.chart(id,{exporting:{buttons:{contextButton:{menuItems:["viewFullscreen","separator","downloadPNG","downloadPDF"]}}},chart:{type:'pie',options3d:{enabled:!1,alpha:45,beta:0}},legend:{enabled:!0,align:'right',verticalAlign:'top',layout:'vertical',y:35,width:100,useHTML:!0,},title:{text:title},subtitle:{text:datas[0].name+' - '+datas[1].name},tooltip:{pointFormat:'{series.name}: <b>{point.percentage:.1f}%</b>'},plotOptions:{pie:{allowPointSelect:!0,cursor:'pointer',depth:35,borderWidth:0,colors:colors,},series:{dataLabels:{verticalAlign:'top',enabled:!0,color:'#000000',connectorWidth:1,distance:-30,connectorColor:'#000000',formatter:function(){return this.percentage>=5?Math.round(this.percentage,2)+' %':''}}}},series:datas})};function drawDualPieVerticalChart(id,title,datas){var colors=[],base='#de1128',i;for(i=1;i<7;i+=1){c={h:(360/7)*i,l:0.47,s:0.86};colors.push(hslToRGB(c))}
colors.push('#535656');colors.push('#000000');colors.push('#ffffff');datas[0].showInLegend=!0;datas[1].showInLegend=!1;Highcharts.chart(id,{exporting:{buttons:{contextButton:{menuItems:["viewFullscreen","separator","downloadPNG","downloadPDF"]}}},chart:{type:'pie',options3d:{enabled:!0,alpha:45,beta:0}},legend:{enabled:!0,align:'center',verticalAlign:'bottom',layout:'vertical',y:0,width:200,useHTML:!0,},title:{text:title},subtitle:{text:datas[0].name+' - '+datas[1].name},tooltip:{pointFormat:'{series.name}: <b>{point.percentage:.1f}%</b>'},plotOptions:{pie:{allowPointSelect:!0,cursor:'pointer',depth:35,borderWidth:0,colors:colors,},series:{dataLabels:{verticalAlign:'top',enabled:!0,color:'#000000',connectorWidth:1,distance:-30,connectorColor:'#000000',formatter:function(){return this.percentage>=5?Math.round(this.percentage,2)+' %':''}}}},series:datas})};function drawVuChart(id,title,datas){var panes=[];var yAx=[];for(i=0;i<datas.length;i++){if(datas[i].data[0]>120)
datas[i].data[0]=120;panes.push({startAngle:-25,endAngle:25,background:null,center:[(2*(i+1)-1)*100/(datas.length*2)+'%','145%'],size:300});yAx.push({min:0,max:120,minorTickPosition:'outside',tickPosition:'outside',labels:{rotation:'auto',distance:20},plotBands:[{from:100,to:120,color:'#C02316',innerRadius:'100%',outerRadius:'105%'}],pane:i,title:{text:datas[i].name,y:-40}})}
Highcharts.chart(id,{chart:{type:'gauge',plotBorderWidth:1,plotBackgroundColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,'#FFF4C6'],[0.3,'#FFFFFF'],[1,'#FFF4C6']]},plotBackgroundImage:null,height:200},title:{text:title},pane:panes,exporting:{enabled:!1},tooltip:{enabled:!1},yAxis:yAx,plotOptions:{gauge:{dataLabels:{enabled:!1},dial:{radius:'100%'}}},series:datas})};function ganttChart(id,title,colors,cats,datas){return Highcharts.ganttChart(id,{title:{text:title},xAxis:{currentDateIndicator:{width:1,dashStyle:'dot',color:'#de1128',label:{format:'Today'}}},yAxis:{categories:cats},plotOptions:{gantt:{colors:colors}},series:datas})};function drawDualChart(id,unit,datas,imgValid,categories=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],zoomed=0){var yMin=null;var yMax=null;if(parseInt(zoomed)){yMax=0;yMin=1000000000;for(i=0;i<categories.length;i++){if(datas[0].data[i].y&&datas[0].data[i].y>yMax)
yMax=datas[0].data[i].y;if(datas[0].data[i].y&&datas[0].data[i].y<yMin)
yMin=datas[0].data[i].y;if(datas[1].data[i]&&datas[1].data[i]>yMax)
yMax=datas[1].data[i];if(datas[1].data[i]&&datas[1].data[i]<yMin)
yMin=datas[1].data[i]}
if(yMin>yMax)
yMin=yMax;yMin=yMin*0.9999}
var cellWidth=$(window).width()/22;return Highcharts.chart(id,{chart:{events:{redraw:function(event){if(typeof HighChartsRedraw!=='undefined'){HighChartsRedraw()}}},zoomType:'xy',height:$('#'+id).height(),margin:[0,0,0,0],marginLeft:cellWidth,marginTop:30,marginBottom:30,spacingLeft:50},title:{text:''},xAxis:[{categories:categories,crosshair:!0}],yAxis:[{title:{text:unit},min:yMin,max:yMax}],tooltip:{useHTML:!0,formatter:function(){var s='<table class="table-borderless">';var sum=0;if(this.x)
s+='<tr><td colspan="2" class="standard-black" style="border-bottom:2px solid black"><b>'+this.x+'</b></td></tr>';var nb=0;$.each(this.points,function(i,point){if(point.point.barX){s+='<tr><td class="standard-black"><i class="fas fa-square-full" style="color:'+(point.color?point.color:point.series.color)+';"></i> '+point.series.name+' </td>'+'<td class="standard-black" style="text-align:right;padding-left:5px;"><b>'+(new Intl.NumberFormat('fr-FR').format(point.y))+'</b></td></tr>';sum+=point.y;nb++}});if(nb>1)
s+='<tr><td style="border-top:2px solid black"><i>Sum stacked bar</i></td><td  style="border-top:2px solid black;text-align:right"><b>'+(new Intl.NumberFormat('fr-FR').format(sum))+'</b></td></tr>';$.each(this.points,function(i,point){if(!point.point.barX){s+='<tr><td class="standard-black" style="border-top:2px solid black;"><i class="fas fa-slash" style="color:'+(point.color?point.color:point.series.color)+';"></i> '+point.series.name+' </td>'+'<td class="standard-black" style="border-top:2px solid black;text-align:right;padding-left:5px;"><b>'+(new Intl.NumberFormat('fr-FR').format(point.y))+'</b></td></tr>'}});s+='</table>';return s},shared:!0},plotOptions:{series:{}},legend:{enabled:!1},series:datas},function(chart){chart.renderer.image(imgValid,0,10,50,50).add()})};function drawStackedBarAndLineChart(id,unit,datas,imgValid,categories=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],zoomed=0){var yMin=null;var yMax=null;if(parseInt(zoomed)){yMax=0;yMin=1000000000;for(i=0;i<categories.length;i++){if(datas[0].data[i].y&&datas[0].data[i].y>yMax)
yMax=datas[0].data[i].y;if(datas[0].data[i].y&&datas[0].data[i].y<yMin)
yMin=datas[0].data[i].y;if(datas[1].data[i].y&&datas[1].data[i].y>yMax)
yMax=datas[1].data[i].y;if(datas[1].data[i].y&&datas[1].data[i].y<yMin)
yMin=datas[1].data[i].y}
if(yMin>yMax)
yMin=yMax;yMin=yMin*0.9999;console.log(yMin+' / '+yMax)}
var cellWidth=$(window).width()/22;return Highcharts.chart(id,{chart:{zoomType:'xy',height:$('#'+id).height(),margin:[0,0,0,0],marginLeft:cellWidth,marginTop:20,marginBottom:25,spacingLeft:50},title:{text:''},xAxis:[{categories:categories,crosshair:!0}],yAxis:[{title:{text:unit},min:yMin,max:yMax,stackLabels:{enabled:!1,}}],plotOptions:{column:{stacking:'normal'},},tooltip:{useHTML:!0,formatter:function(){var s='<table class="table-borderless">';var sum=0;if(this.x)
s+='<tr><td colspan="2" class="standard-black" style="border-bottom:2px solid black"><b>'+this.x+'</b></td></tr>';var nb=0;$.each(this.points,function(i,point){if(point.point.barX){s+='<tr><td class="standard-black"><i class="fas fa-square-full" style="color:'+(point.color?point.color:point.series.color)+';"></i> '+point.series.name+' </td>'+'<td class="standard-black" style="text-align:right;padding-left:5px;"><b>'+(new Intl.NumberFormat('fr-FR').format(point.y))+'</b></td></tr>';sum+=point.y;nb++}});if(nb>1)
s+='<tr><td style="border-top:2px solid black"><i>Sum stacked bar</i></td><td  style="border-top:2px solid black;text-align:right"><b>'+(new Intl.NumberFormat('fr-FR').format(sum))+'</b></td></tr>';$.each(this.points,function(i,point){if(!point.point.barX){s+='<tr><td class="standard-black" style="border-top:2px solid black;"><i class="fas fa-slash" style="color:'+(point.color?point.color:point.series.color)+';"></i> '+point.series.name+' </td>'+'<td class="standard-black" style="border-top:2px solid black;text-align:right;padding-left:5px;"><b>'+(new Intl.NumberFormat('fr-FR').format(point.y))+'</b></td></tr>'}});s+='</table>';return s},shared:!0},legend:{enabled:!1},series:datas},function(chart){chart.renderer.image(imgValid,0,10,50,50).add()})};function drawStackedBar(id,title,unit,categories,datas,band=1000000,stacking='normal'){return Highcharts.chart(id,{chart:{type:'column',height:$('#'+id+'.col-md-6').length?400:500,events:{redraw:function(event){if(typeof HighChartsRedraw!=='undefined'){HighChartsRedraw(id)}}},},title:{text:title},legend:{enabled:(datas.length==1?!1:!0),align:'right',verticalAlign:'top',layout:'vertical',y:35,width:'20%',useHTML:!0,},xAxis:[{categories:categories,plotBands:[{from:band-0.5,to:band+0.5,color:'#E3F6FC'}],labels:{step:1,},isDirty:!0,}],yAxis:[{title:{text:unit},}],plotOptions:{column:{stacking:stacking}},tooltip:{useHTML:!0,formatter:function(){var s='<table><tr><td colspan="2" style="border-bottom:2px solid black"><b>'+this.x+'</b></td></tr>',sum=0;$.each(this.points,function(i,point){s+='<tr><td><i class="fas fa-square-full" style="color:'+point.series.color+';"></i> '+point.series.name+' </td>'+'<td style="text-align:right;padding-left:5px;"><b>'+(new Intl.NumberFormat('fr-FR').format(point.y))+'</b></td></tr>';sum+=point.y});s+='<tr><td style="border-top:2px solid black"><i>Sum</i></td><td  style="border-top:2px solid black;text-align:right"><b>'+(new Intl.NumberFormat('fr-FR').format(sum))+'</b></td></tr>';s+='</table>';return s},shared:!0,},series:datas})};$(function(){var chart;$('select').on('change',function(){})});function drawMapChart(id,title,pointFormat,data){var minX=180,maxX=-180,minY=180,maxY=-180;for(i=0;i<data.length;i++){if(data[i].lat<minX)
minX=data[i].lat;if(data[i].lat>maxX)
maxX=data[i].lat;if(data[i].lon<minY)
minY=data[i].lon;if(data[i].lon>maxY)
maxY=data[i].lon}
var chart=Highcharts.mapChart(id,{chart:{borderWidth:0,map:'custom/world'},title:{text:title},subtitle:{text:'No filter'},legend:{enabled:!1},mapNavigation:{enabled:!0,buttonOptions:{verticalAlign:'bottom'}},series:[{name:'Countries',color:'#e0e0e0',enableMouseTracking:!1},{type:'mapbubble',name:title,data:data,minSize:10,maxSize:'20%',tooltip:{pointFormat:pointFormat}}]});point=chart.fromLatLonToPoint({"lat":(minX+maxX)/2,"lon":(minY+maxY)/2});chart.mapZoom(0.25,point.x,point.y);return chart}
function getMapBlankStructure(lat,lon,city){return{lat:lat,lon:lon,z:0,city:city,color:"#1128de"}}
function updateSubtitleFromFilters(chart){if(!chart)
return;var filter=[];$('select.select-filter').each(function(){if($(this).val())
filter.push($(this).find('option[value='+$(this).val()+']').text())});if(filter.length)
subtitle='Filter: '+filter.join(' / ');else subtitle='No filter';chart.setTitle(null,{text:subtitle})};function networkChart(id,title,nodes,data){Highcharts.chart(id,{chart:{type:'networkgraph',height:'400px'},title:{text:title},plotOptions:{networkgraph:{keys:['from','to'],layoutAlgorithm:{enableSimulation:!1,integration:'euler',friction:-0.9}}},series:[{dataLabels:{enabled:!0,linkFormat:''},id:'lang-tree',nodes:nodes,data:data,}]})}